<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="top.guxx.infrastructure.dao.UserInfoMapper">

    <!-- 结果映射 -->
    <resultMap id="DataBaseMcpRespMap" type="top.guxx.domain.database.model.DataBaseMcpResp">
        <id property="id" column="id" />
        <result property="name" column="name" />
        <result property="age" column="age" />
        <result property="gender" column="gender" />
        <result property="address" column="address" />
    </resultMap>

    <!-- 查询所有用户 -->
    <select id="findAll" resultMap="DataBaseMcpRespMap">
        SELECT
            id,
            name,
            age,
            gender,
            address
        FROM user_info
        ORDER BY id ASC
    </select>

    <!-- 根据条件查询用户 -->
    <select id="findAllByRequest" parameterType="top.guxx.domain.database.model.DataBaseMcpRequest" resultMap="DataBaseMcpRespMap">
        SELECT
        id,
        name,
        age,
        gender,
        address
        FROM user_info
        <where>
            <!-- 根据id查询 -->
            <if test="id != null">
                AND id = #{id}
            </if>

            <!-- 根据姓名模糊查询 -->
            <if test="name != null and name != ''">
                AND name LIKE CONCAT('%', #{name}, '%')
            </if>

            <!-- 根据年龄查询 -->
            <if test="age != null and age != ''">
                AND age = #{age}
            </if>

            <!-- 根据性别查询 -->
            <if test="gender != null">
                AND gender = #{gender}
            </if>

            <!-- 根据地址模糊查询 -->
            <if test="address != null and address != ''">
                AND address LIKE CONCAT('%', #{address}, '%')
            </if>
        </where>
        ORDER BY id ASC
    </select>

</mapper>